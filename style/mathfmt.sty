%
% This is file "mathfmt.sty"
%
% Copyright (C) 2025 by Githubonline1396529 <yyg249942899@163.com>
%
% This work may be distributed and/or modified under the
% conditions of the LaTeX Project Public License, either version 1.3
% of this license or (at your option) any later version.
% The latest version of this license is in
%   https://www.latex-project.org/lppl.txt
% and version 1.3c or later is part of all distributions of LaTeX
% version 2008 or later.
%
\NeedsTeXFormat{LaTeX2e}
\ProvidesClass{style/mathfmt}[
  2025/04/21 v1.0 The math format and theorem environment.]

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Packages for inserting math fomulas,
\RequirePackage{amsmath, amssymb, mathrsfs} % Packages for math fomulas.

% Add the first-level chapter number to the formula number
\numberwithin{equation}{section}
\RequirePackage{siunitx} % International Standerd System of Unit.

% Differential operation symbol
\DeclareMathOperator{\diff}{\,\mathrm{d}\hspace{-1.5pt}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Math theorem environment.

% Package for math theorem environment.
\RequirePackage{amsthm}

\renewcommand{\proofname}{证明}
\renewenvironment{proof}[1][\proofname]{\par
  \pushQED{\qed}%
  \normalfont \topsep6\p@\@plus6\p@\relax
  \trivlist
  \item\relax
  {%
    \hspace{\parindent}\rmfamily\bfseries #1\@addpunct{:}%
  }\hspace\labelsep\ignorespaces
}{%
  \popQED\endtrivlist\@endpefalse
}

\newtheoremstyle{newthmstyle}
  {3bp} % Space above
  {3bp} % Space below
  {\rm} % Body font
  {\parindent} % Indent amount
  {\bfseries} % Theorem head font
  {} % Punctuation after theorem head
  {1.0em} % Space after theorem head
  {} % Theorem head spec (can be left empty, meaning `normal')
\theoremstyle{newthmstyle}
\newtheorem{Definition}{定义}[section]
\newtheorem{Proposition}{命题}[section]
\newtheorem{Lemma}{引理}[section]
\newtheorem{Theorem}{定理}[section]
\newtheorem{Example}{例}[section]
\newtheorem{Problem}{问题}[section]
\newtheorem{Corollary}{推论}[section]
\newtheorem{Remark}{注}[section]

% Theorem environment style with literature citations.
\newtheoremstyle{newthmstyle-cited}
  {3bp} % Space above
  {3bp} % Space below
  {\rm} % Body font
  {\parindent} % Indent amount
  {\bfseries} % Theorem head font
  {} % Punctuation after theorem head
  {1.0em} % Space after theorem head
  {\thmname{#1}\thmnumber{#2}\thmnote{\rm{}#3}} % Theorem head spec.
\theoremstyle{newthmstyle-cited}
\newtheorem{Definition-cited}[Definition]{定义}
\newtheorem{Proposition-cited}[Proposition]{命题}
\newtheorem{Lemma-cited}[Lemma]{引理}
\newtheorem{Theorem-cited}[Theorem]{定理}
\newtheorem{Example-cited}[Example]{例}
\newtheorem{Problem-cited}[Problem]{问题}
\newtheorem{Corollary-cited}[Corollary]{推论}
\newtheorem{Remark-cited}[Remark]{注}

\newcommand{\conclusionname}{结论}
\newenvironment{conclusion}{
  \ifthenelse{\equal{\conclusionname}{结论}}{
    % If it is true, it indecates that the `\conclusionname' is not redefined.
    \renewcommand{\conclusionname}{结论} 
  }{} 
  % If it is false, it indicates that the `\conclusionname' has been redefined
  % in the premable area of the document. Therefore, no operation is taken and
  % the defination in the premable area is accepted first.
  \vspace*{0pt}
  \begin{flushleft}\bfseries\zihao{3}\conclusionname\end{flushleft}%
  \phantomsection
  \addcontentsline{toc}{section}{\conclusionname}%
  \par
}{\par}
